(()=>{function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var r={},n={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"};r.setup=function(e){jwplayer("video-container").setup({playlist:[{file:e}]})},r.get=function(t,a){r.resetFormFields();fetch(t,{headers:n}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(t){a.selectedVideoTitle.value=t.title,a.selectedVideoProducer.value=t.producer,a.selectedVideoGenre.value=t.genre,a.selectedVideoDescription.value=t.description;var n=document.getElementById("video-thumbnail");n.classList.remove("hidden"),n&&t.metadata.thumbnail_filename&&(n.src="/storage/images/jpeg/"+t.metadata.thumbnail_filename);var i=document.getElementById("metadata-attributes");if(i){var o,c=["thumbnail_filepath","thumbnail_filename","preview_filename","preview_filepath"];(o=document.createElement("tr")).innerHTML='<td class="whitespace-nowrap">Filename</td>\n                             <td class="whitespace-nowrap">\n                                 <a href="/watch/'.concat(t.id,'" class="text-blue-400">').concat(t.filename,"</a>\n                             </td>"),i.appendChild(o),o=document.createElement("tr");var l=r.formatFilePath(t.filepath);o.innerHTML='<td class="whitespace-nowrap">Filepath</td>\n                             <td class="whitespace-nowrap">'.concat(l,"</td>"),i.appendChild(o);for(var s=0,d=Object.entries(t.metadata);s<d.length;s++){var u=e(d[s],2),p=u[0],f=u[1];c.includes(p)||("video_id"===p&&(p="ID"),"filesize"===p&&(f=r.formatFileSize(f)),p=p.charAt(0).toUpperCase()+p.slice(1),(o=document.createElement("tr")).innerHTML='<td class="whitespace-nowrap">'.concat(p,'</td>\n                                     <td class="whitespace-nowrap">').concat(f,"</td>"),i.appendChild(o))}}})).catch((function(e){return console.log(e)}))},r.update=function(e,t){r.resetFormFields();var a={title:t.selectedVideoTitle.value,producer:t.selectedVideoProducer.value,genre:t.selectedVideoGenre.value,description:t.selectedVideoDescription.value};n=Object.assign({},n,{"X-CSRF-Token":document.querySelector('input[name="_token"]').value});fetch(e,{headers:n,method:"PUT",body:JSON.stringify(a)}).then((function(e){if(!e.ok){if(422===e.status)return e.json();throw new Error(e.statusText)}return e.json()})).then((function(e){e.errors?Object.keys(e.errors).forEach((function(t){var r=document.querySelector("#"+t+"-error");r.classList.remove("hidden"),r.innerText=e.errors[t][0]})):alert("Data successfully updated.")})).catch((function(e){return console.log(e)}))},r.preview=function(e){var t=e.querySelector("img");if(t){t.classList.add("hidden");var r=e.querySelector("video");r?r.classList.remove("hidden"):((r=document.createElement("video")).classList.add("media"),r.src=t.src.replace("/images/jpeg","/previews").replace(".jpg",""),r.loop=!0,r.muted=!0,e.appendChild(r,t)),r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>r.HAVE_CURRENT_DATA||r.play().then().catch((function(){}))}},r.unpreview=function(e){var t=e.querySelector("video");if(t){t.pause(),t.currentTime=0,t.classList.add("hidden");var r=e.querySelector("img");r&&r.classList.remove("hidden")}},r.resetFormFields=function(){document.querySelectorAll(".error").forEach((function(e){return e.classList.add("hidden")})),document.getElementById("metadata-attributes").innerHTML=null},r.formatFilePath=function(e){var t=e.split("/");return t.pop(),t.join("/")},r.formatFileSize=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var r=1024,n=t<0?0:t,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,i)).toFixed(n))+" "+a[i]},window._video=r})();